\documentclass[12pt]{article}
\usepackage{graphicx}
\setlength{\parindent}{0in}

% General Latex  --------------------------------------------------
\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\def\beqar{\begin{eqnarray}}
\def\eeqar{\end{eqnarray}}
\def\nn{\nonumber}
\def\ol{\overline}
\def\para{\parallel}

% Operators  ------------------------------------------------------
\newcommand{\diff}[2]{\frac{d#1}{d#2}}
\newcommand{\diffs}[2]{\frac{d^2#1}{d#2^2}}
\newcommand{\pdiff}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\pdiffs}[2]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\pdiffxy}[3]{\frac{\partial^2#1}{\partial#2 \partial#3}}
\newcommand{\pdt}{\partial_t}
\newcommand{\pdr}{\partial_r}
\newcommand{\pdth}{\partial_\theta}
\newcommand{\pdrr}{\partial^2_r}

\newcommand{\enum}[2]{{#1}\times10^{#2}} % 4.2x10^{3} = \enum{4.2}{3}

\newcommand{\vect}[1]{{\bf #1}}
%\newcommand{\vect}{\overrightarrow}
%\newcommand{\vect}{\vec}
\def\div{\nabla\cdot}
\def\grad{\nabla}
\def\curl{\nabla\times}
\newcommand{\gradpar}{\grad_\parallel}
\newcommand{\gradperp}{\grad_\perp}
\newcommand{\gradr}{\grad_r}
\newcommand{\defeq}{\ensuremath{\stackrel{\text{\tiny def}}{=}}}

\newcommand{\savg}[1]{\left<{#1}\right>}
\newcommand{\vavg}[1]{\left<{#1}\right>_V}
\newcommand{\thavg}[1]{\left<{#1}\right>_\theta}

% Variable names  -------------------------------------------------
\newcommand{\vpar} {v_\parallel}
\newcommand{\Apar} {A_\parallel}
\newcommand{\jpar} {j_\parallel}
\newcommand{\kpar} {k_\parallel}
\newcommand{\kperp} {k_\perp }
\newcommand{\vperp} {v_\perp }
\newcommand{\kthe}{k_\theta}

\newcommand{\Evec}{\ensuremath{\boldsymbol{{\rm E}}}}
\newcommand{\Bvec}{\ensuremath{\boldsymbol{{\rm B}}}}
\newcommand{\Jvec}{\ensuremath{\boldsymbol{{\rm J}}}}
\newcommand{\Fvec}{\ensuremath{\boldsymbol{{\rm F}}}}
\newcommand{\fvec}{\ensuremath{\boldsymbol{{\rm f}}}}
\newcommand{\vE}{\ensuremath{\boldsymbol{{\rm v}_{E}}}}
\newcommand{\bo}{\ensuremath{\boldsymbol{{\rm b}_0}}}
\newcommand{\bvec}{\ensuremath{\boldsymbol{{\rm b}}}}
\newcommand{\xvec}{\ensuremath{\boldsymbol{{\rm x}}}}
\newcommand{\yvec}{\ensuremath{\boldsymbol{{\rm y}}}}
\newcommand{\zvec}{\ensuremath{\boldsymbol{{\rm z}}}}
\newcommand{\vvec}{\ensuremath{\boldsymbol{{\rm v}}}}
\newcommand{\jvec}{\ensuremath{\boldsymbol{{\rm j}}}}

\newcommand{\bxgp}{\bvec\times\gradperp}

\newcommand{\vve}{\ensuremath{\boldsymbol{{\rm v}}_{e}}}
\newcommand{\vvi}{\ensuremath{\boldsymbol{{\rm v}}_{i}}}
\newcommand{\vpe}{v_{\parallel e}}
\newcommand{\vpi}{v_{\parallel i}}
\newcommand{\vvE}{\ensuremath{\boldsymbol{{\rm v}}_{E}}}
\newcommand{\vvD}{\ensuremath{\boldsymbol{{\rm v}}_{D}}}

\newcommand{\nuei}{\nu_{ei}}
\newcommand{\nuii}{\nu_{ii}}
\newcommand{\nue}{\nu_{e}}
\newcommand{\nuen}{\nu_{en}}
\newcommand{\nuin}{\nu_{in}}
\newcommand{\kpe}{\kappa_{\parallel e}}

\newcommand{\rs}{\rho_{s}}
\newcommand{\ri}{\rho_{i}}
\newcommand{\wci}{\Omega_{i}}
\newcommand{\wcix}{\Omega_{ix}}
\newcommand{\wce}{\Omega_{e}}
\newcommand{\tomega}{\tilde\omega}
\newcommand{\Isat}{I_{\rm sat}}
\newcommand{\fmie}{\frac{m_i}{m_e}}
\newcommand{\fmei}{\frac{m_e}{m_i}}


% Often used dimensions
\newcommand{\cm}{\rm cm}
\newcommand{\mm}{\rm mm}
\newcommand{\cmn}{{\rm cm}^{-3}}
\newcommand{\mn}{{\rm m}^{-3}}
\newcommand{\eV}{\rm eV}
\newcommand{\G}{\rm G}
\newcommand{\T}{\rm T}



\begin{document}


{\bf \large Energy Dynamics in a Simulation of LAPD Turbulence \\
 \\
 \\} 
Brett Friedman \\
Updated: \today \\

\hrulefill

\section{Introduction}
It is common practice to study a system's linear stability properties to gain insight into tubulent dynamics. It is often easier to calculate and analyze linear modes and growth rates than
to simulate and analyze nonlinear turbulence. However, there are several situations in which linear properties can be misleading in understanding turbulent systems. First,
linear studies that neglect stable branches of the linear dispersion relation often miss details of nonlinear dynamics. For example, stable eigenmodes can often
impact nonlinear dynamics by providing energy sinks and sometimes energy sources not found on the most unstable linear branch
\cite{baver2002,terry2002,terry2006a,terry2006b,gatto2006,terry2009,hatch2009,kim2010,makwana2011,hatch2011}. Stable eigenmodes can shift
the energy injection and dissipation ranges, making the turbulent dynamics very different from the Kolmogorov picture of hydrodynamic turbulence \cite{Kolmogorov1941}.
Second, systems with non-normal modes (non-orthogonal eigenvectors) display properties that are unexpected from linear calculations \cite{kim2010,camargo1998}. 
In fact, systems with non-normal modes even make it difficult to predict dynamics
when stable eigenmode branches are included in analyses. Third, linear stability analyses miss crucial nonlinear instability effects, which come in several varieties. \\

The most obvious variety of a nonlinear instability effect is that of subcritical turublence in which no linear instabilities exist but turbulence is self-sustained 
given strong enough finite-amplitude perturbations. Several cases of subcritical plasma instabilities have been shown in the literature \cite{scott1990,scott1992,drake1995,nordman1993,waltz1985}.
The second variety includes cases in which a particular linear instability is present in a system, but the turbulence is maintained
by a nonlinear instability mechanism with different physical origin than the linear instability mechanism. This has been thoroughly explored in tokamak edge simulations in which
linear ballooning instability drive is overtaken in the saturated phase by a nonlinear drift-wave drive \cite{zeiler1996,zeiler1997,scott2002,scott2003,scott2005}.
Finally, it is often found that a particular linear instability is enhanced and modified in the saturated phase by a nonlinear instability with a similar mechanism as the linear instability,
but which depends on nonlinear wavenumber transfers to increase or cause drive \cite{biskamp1995,korsholm1999}. \\

In order to avoid the pitfalls of relying too heavily on linear stability calculations in forming conclusions on turbulence characteristics, it is useful to diagnose turbulent simulations
with energy dynamics analyses. Energy dynamics analyses track energy input into turbulent fluctuations and energy dissipation out of them. They also track conservative energy transfer
between different energy types (e.g. from potential to kinetic energy) and between different scales, waves, or eigenmodes of a system. In this study, a previously verified and validated
two-fluid Braginskii model of turbulence in the Large Plasma Device (LAPD) is subjected to such an energy dynamics analysis. The result is that a nonlinear instability drives and maintains
the turbulence in the steady state saturated phase of the simulation. While a linear restistive drift wave instability resides in the system, the nonlinear drift wave instability dominates
when the fluctuation amplitude becomes large enough. The nonlinear instability is identified by its energy growth rate spectrum, which varies significantly from the linear growth rate spectrum.


\section{The drift wave model}
\label{dw_model}

A Braginskii fluid model \cite{Braginskii1965} is used to simulate drift wave turbulence in LAPD. 
The evolved variables used in the model are the plasma density, $N$, the electron fluid parallel velocity $\vpe$, the potential vorticity $\varpi = \gradperp \cdot (N_0 \gradperp \phi)$,
and the electron temperature $T_e$. Cold ions are used, which eliminates ion temperature gradient drive, and sound wave effects are neglected. Details and derivations of the model
may be found in previous verification and validation studies \cite{Popovich2010a,Popovich2010b,Umansky2011}, although electron temperature fluctuations were not included in those studies.

The equations appear with Bohm normalizations: lengths are normalized to $\rho_s$, times to $\omega_{ci}^{-1}$, velocities to $c_s$, densities to the equilibrium peak density, and electron
temperatures and potentials to the equilibrium peak electron temperature. The equations are:

\beqar
\label{ni_eq}
\pdt N = - {\mathbf v_E} \cdot \grad N_0 - N_0 \gradpar \vpe + \mu_N \gradperp^2 N + S_N + \{\phi,N\}, \\
\label{ve_eq}
\pdt \vpe = - \fmie \frac{T_{e0}}{N_0} \gradpar N + \fmie \gradpar \phi - \nue \vpe + \{\phi,\vpe \}, \\
\label{rho_eq}
\pdt \varpi = - N_0 \gradpar \vpe  - \nuin \varpi + \mu_\phi \gradperp^2 \varpi + \{\phi,\varpi \}, \\
\label{te_eq}
\pdt T_e = - {\mathbf v_E} \cdot \grad T_{e0} - 1.71 \frac{2}{3} T_{e0} \gradpar \vpe + \frac{2}{3 N_0} \kpe \gradpar^2 T_e  \nonumber \\
- \frac{2 m_e}{m_i} \nue T_e  + \mu_T \gradperp^2 T_e +  S_T + \{\phi,T_e\}.
\eeqar

In these equations, $\mu_N$, $\mu_T$, and $\mu_\phi$ are artificial diffusion and viscosity coefficients used for subgrid dissipation. They are large enough to achieve saturation
and grid convergence, but small enough to allow for turbulence to develop. The value used in the simulations is $1.5 \times 10^{-3}$. The electron collisionality $\nue$, ion-neutral
collisionality $\nuin$, parallel electron thermal conductivity $\kpe$, and mass ratio $\fmie$ are calculated from the experimental parameters.
There are two sources of free energy: the density gradient due to the equilibrium density profile $N_0$, and the equilibrium electron temperature gradient in $T_{e0}$, both of which are
taken from experimental fits. $N_0$ and $T_{e0}$ are only functions of the distance from the axis $r$. \\

The terms in Poisson brackets are the advective nonlinearities, which are the only nonlinearities used in the simulations.
The numerical simulations are fully spatial in all three dimensions (as opposed to spectral) and use cylindrical annular geometry ($12<r<40 cm$).
The simulations use periodic boundary conditions in the axial ($z$) direction and Dirichlet boundary
conditions in the radial ($r$) direction for the fluctuating quantities. \\

Simulations also use density and temperature sources ($S_n$ and $S_T$) in order to keep the equilibrium profiles from relaxing away from their experimental shapes. 
These sources subtract out the azimuthal averages ($m=0$ zonal component of the density and temperature fluctuations) at each time step. 
Zonal flows are allowed to form and evolve. The parallel current, which is often found explicitly in these equations is replaced here by $J_\para = - N_0 \vpe$. \\


\section{Energetics Machinery}
\label{sec_energetics_machinery}


The expression for the normalized energy of the wave fluctuations in the drift wave model is:

\beq
\label{energy_eq}
E = \frac{1}{2} \int_V  (N^2 + \frac{3}{2} T_e^2 + \frac{m_e}{m_i} \vpe^2 + N_0 (\gradperp \phi)^2 ) dV.
\eeq

The $N^2$ contribution is the potential energy due to density fluctuations, $\frac{3}{2} T_e^2$ is the electron temperature fluctuation potential energy,
$\frac{m_e}{m_i} \vpe^2$ is the parallel electron kinetic energy, and $N_0 (\gradperp \phi)^2$ is the $E \times B$ perpendicular kinetic energy.
These energies are conserved individually by their respective advective nonlinearities. \\

It is most instructive to analyze the spectral energy dynamics rather than the total energy dynamics. To do this, each field at a given time is Fourier decomposed as 
$f(r,\theta,z) = \sum_k f_k(r) e^{i (m \theta + k_z z )}$,
where the subscript $k$ represents the spectral wavenumbers, $(m,n)$. $m$ is the azimuthal wavenumber while $n$ is the axial integer wavenumber such that $k_z = \frac{2 \pi n}{l_z}$. Note that
the radial direction is not spectrally decomposed because the radial dependence of the profiles and differential operators complicates the analysis.
Then, the energy of each Fourier $(m,n)$ mode is

\beq
\label{E_k}
E_{tot}(k) = \left< |n_k|^2 + \frac{3}{2} |t_k|^2 + \frac{m_e}{m_i} |v_k|^2 + N_0 \left| \pdiff{\phi_k}{r} \right|^2 + N_0 \frac{m^2}{r^2} |\phi_k|^2 \right>,
\eeq

where the brackets $\left< \right>$ represent the radial integral: $\int_{r_a}^{r_b} r dr$.
The energy evolution for each Fourier mode of each field has the form:

\beq
\label{dEdt_j}
\pdiff{E_{j}(k)}{t} = Q_{j}(k) + C_{j}(k) + D_j(k) + \sum_{k'} T_{j}(k,k').
\eeq

The index $j$ stands for each field, ($n,t,v,\phi$), and the sum over $j$ gives the total energy evolution. The derivation of equation \ref{dEdt_j} 
is given in the appendix along with the full expressions for each of the parts. $T_{j}(k,k')$ is the nonlinear energy transfer function that comes from the advective
nonlinearities.  It describes the nonlinear energy transfer rate of modes $k'=(m',n')$ and $k-k'=(m-m',n-n')$ to the mode $k=(m,n)$. 
In other words, a positive value of $T_{j}(k,k')$ indicates that fluctuations
at wavenumber $k$ gain energy from gradient fluctuations at wavenumber $k'$ and flow fluctuations at wavenumber $k-k'$.
When summed over $k'$ as in equation \ref{dEdt_j}, the result is the total
nonlinear energy transfer into mode $k$. Note that $\sum_{k,k'} T_{j}(k,k') = 0$ because the nonlinearities conserve energy individually in each of equations \ref{ni_eq}-\ref{te_eq}.
This is easily proven by the following identity:

\beq
\label{poisson_rln}
\int_\Omega q \{p,q\} \ d\Omega = \int_\Omega p \{p,q\} \ d\Omega = 0,
\eeq

which holds when boundary conditions are periodic or zero value as they are in the simulation. 
The fact that the advective nonlinearities conserve energy means that they can transfer energy between different Fourier waves,
but they cannot change the energy of the volume-averaged fluctuations as a whole. Only the linear terms do this.
Other possible nonlinearities that do not conserve energy are not included in the model equation set or in simulations. 
Furthermore, it is important that the simulations employ an energy conserving finite difference
scheme for the advective nonlinearities, and most common numerical advection schemes do not have this property. Therefore, an Arakawa advection scheme that conserves 
energy of the advected quantity is used for the nonlinear advection terms in the simulations \cite{arakawa1966}. \\

The linear terms in equations \ref{ni_eq}-\ref{te_eq} do not conserve energy individually or as a whole. The linear terms are broken up into three contributions in equation \ref{dEdt_j}.
$D_{j}(k)$ represents nonconservative energy dissipation due to collisions, artificial diffusion and viscosity, and the purely dissipative density and temperature sources.
Each contribution to $D_j(k)$ is negative. $C_j(k)$ contains the linear terms dubbed ``transfer channels'' \cite{scott2002}. They are rewritten here:

\beqar
C_n(k) & = & Re \left\{ \left< - i k_z N_0 v_k n_k^* \right> \right\}
\label{Cnk} \\
C_v(k) & = & Re \left\{ \left<  - i k_z N_0 n_k v_k^* + i k_z N_0 \phi_k v_k^* - 1.71 i k_z T_{e0} t_k v_k^*  \right> \right\}
\label{Cvk} \\
C_\phi(k) & = & Re \left\{ \left< i k_z N_0 v_k \phi_k^* \right> \right\}
\label{Cpk} \\
C_t(k) & = & Re \left\{ \left< - 1.71 i k_z T_{e0} v_k t_k^* \right> \right\}
\label{Ctk}
\eeqar

Notice that $C_n(k) + C_v(k) + C_\phi(k) + C_t(k) = 0$, which is most clearly seen upon conjugation of $C_v(k)$ inside the real part operator.
This is the reason why these terms are called transfer channels. They represent the transfer
between the different types of energy of the different fields ($N,\phi,T_e \leftrightarrow v_{\para e}$), but taken together, they do not create or dissipate total
energy from the system. The only energy field transfer in this system occurs through the parallel electron velocity (parallel current) dynamics. There is no direct transfer between
the state variables $N, \phi,$ and $T_e$.  Altogether, the coupling through the parallel current is called the
adiabatic response. It is an essential part of both the linear and nonlinear
drift wave mechanisms \cite{scott2002,scott2005}. The adiabatic response moves energy from the pressure fluctuations to the perpendicular flow through the parallel current. \\


Finally, the $Q_j(k)$ terms represent the nonconservative energy sources. They are rewritten here:

\beqar
Q_n(k) & = & Re \left\{ \left< -\frac{i m}{r} \pdr N_0 \phi_k n_k^*  \right> \right\}
\label{Qnk} \\
Q_v(k) & = & Re \left\{ \left<  i k_z \frac{N_0^2 - T_{e0}}{N_0} n_k v_k^* + i k_z (1 - N_0) \phi_k v_k^* + 1.71 i k_z (T_{e0} -1) t_k v_k^*  \right> \right\} \\
\label{Qvk} \\
Q_\phi(k) & = & 0
\label{Qpk} \\
Q_t(k) & = & Re \left\{ \left< -\frac{3}{2} \frac{i m}{r} \pdr T_{e0} \phi_k t_k^*  \right> \right\}
\label{Qtk}
\eeqar

$Q_n(k)$ is the energy extraction from the equilibrium density profile. This term may have either sign, so it can dissipate fluctuation potential energy from the system as well as create it
at each $k$. $Q_t(k)$ is completely analagous to $Q_n(k)$. 
$Q_v(k)$ is parallel kinetic energy extraction or dissipation. The source of these terms are the equilibrium gradients, which is evident because if the profiles
were flat ($N_0=T_{e0}=1$), all $Q(k)$ would vanish.
Moreover, the particular normalization of equations \ref{ni_eq}-\ref{te_eq} combined with the choice of energy definition (equation \ref{energy_eq}) causes the non-zero $Q_v(k)$.

\section{Nonlinear Energy Dynamics}
\label{nl_en_dynamics_sec}

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{time_evolution}
\hfil
\caption{Time evolution of the volume-averaged total energy. Each time step is $400/\omega_{ci} \sim 170 \mu s$}
\label{time_evolution}
\end{figure}


\begin{figure}
\includegraphics[width=0.45\textwidth,height=60mm]{En_nl}~a)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{Et_nl}~b)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{Ep_nl}~c)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{Ev_nl}~d)
\hfil
\caption{\textbf{a)} $E_n(k)$, \textbf{b)} $E_t(k)$, \textbf{c)} $E_\phi(k)$, and \textbf{d)} $E_v(k)$ in the $m-n$ plane averaged over time during the saturated turbulent phase.}
\label{energy_figures}
\end{figure}

Fig. \ref{time_evolution} shows the time evolution of the total energy of the fluctuations. The simulation starts with a random initial perturbation, and the fluctuations grow
exponentially until reaching saturation. All analysis of the saturated or turbulent stage is done by averaging over the time steps from 100-235 (the simulation uses tens of thousands of internal
time steps for each of these time steps that is output).
The turbulent spectral energy, defined in equation \ref{E_k} is shown in Fig. \ref{energy_figures}. The energy is broken up into its different types. There are a few clear nonlinear properties
seen in these figures. The first is that the energy is located in different spectral regions for the different energy types. This has to be a nonlinear effect because the linear eigenmodes
are Fourier modes in the azimuthal and axial directions and all fields grow at the same rate for an eigenmode. 
Another property unexpected from linear stability analysis is that the majority of the potential energy ($E_n$ and $E_t$) is contained in $n=0$ structures, which are often called convective cells.
This is unexpected because there is no $n=0$ linear instability present in the system, which has been confirmed by eigenvalue calculations. The only linear instability of the system is the
linear resistive drift wave instability, which requires finite $n$ to provide the phase shift and state variable coupling to drive the waves unstable. \\

Clearly, the nonlinearities are responsible for these properties. This model is similar to the Hasegawa-Wakatani model (\cite{hasegawa1983}), and it is well-known in the Hasegawa-Wakatani
model that the nonlinearities cause a dual cascade in the perpendicular wavenumber. The nonlinearity in the density equation tends to cause a forward cascade while the 
polarization nonlinearity in the vorticity equation tends to cause an inverse cascade, creating a difference in the shape of the spectra between the density and potential.
The coupling between the density and potential works to mitigate this difference, with the difference determined by the strengh of the coupling, which is generally measured in terms
of the adiabaticity parameter \cite{Camargo1995}. \\

\begin{figure}
\includegraphics[width=0.45\textwidth,height=60mm]{QDC_n}~a)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{QDC_t}~b)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{QDC_p}~c)
\hfil
\includegraphics[width=0.45\textwidth,height=60mm]{parallel_dynamics}~d)
\hfil
\caption{\textbf{a)} The solid curves quantify the energy dynamics of the density potential energy averaged over time during the saturated turbulent phase. The dashed curves are taken
at a time during the low amplitude linearly dominated phase. The dashed curves are normalized to fit on the same plot as the solid curves. The notation $n \pm 1$ represents the
summation over the $n=1$ and $n=-1$ curves. \textbf{b)} The energy dynamics of the temperature potential energy and \textbf{c)} the perpendicular kinetic energy. \textbf{d)} The parallel
dynamics (adiabatic response). The contributions to $C_v(k)$ are broken up with $C_v(k) = -C_n(k) - C_t(k) - C_\phi(k)$. The density and temperature sources are neglected in \textbf{a)}
and \textbf{b)} respectively. They only contribute at $m=0$.}
\label{nc_dynamics_figures}
\end{figure}

The $n=0$ potential energy dominance is also caused by the nonlinearities, but in a complicated way, first described in \cite{biskamp1995,drake1995}. The mechanism is best described with
help from the energy dynamics machinery derived in section \ref{sec_energetics_machinery}. Fig. \ref{nc_dynamics_figures} summarizes the effects of the nonconservative linear terms, which are
fully responsible for injecting energy into the fluctuations. Fig. \ref{nc_dynamics_figures}a shows the $E_n$ dynamics separated into different parallel wavenumbers and plotted
against the azimuthal wavenumber $m$. Surprisingly, the linear terms inject near equal amounts of energy into $n=0$ convective cell structures as $n= \pm 1$ structures despite the absence
of linear instability at $n=0$. Modes with $n \ge 2$ play a negligible role. Furthermore, all of the net energy injected into the density fluctuations ($Q_n + D_n$) is transferred out ($C_n$) to
the parallel current (electron velocity), which only occurs at finite $n$. The net change of $E_n$ is zero because this analysis is averaged over the steady state
turbulence. The necessary balance implies, as will be proven later, that the nonlinearities transfer energy from $n=0$ convective cells to $n = \pm 1$ modes, where that energy can then
be transfered to the parallel current.
Finally, the dashed curves show the dynamics early on in the linear stage before the nonlinearities make significant contributions. The large difference in the energy injection spectrum between
the linear and saturated turbulent phases indicates that the linear instability mechanism is overtaken by a nonlinear instability mechanism. \\

Fig. \ref{nc_dynamics_figures}b shows the temperature potential energy dynamics. Again convective cells inject energy into the fluctuations, but unlike in the density case, $n = \pm 1$ modes
dissipate more energy than they inject. Moreover, the net positive contribution of $C_t$ reveals that the temperature fluctuations take energy from the parallel current rather than providing
energy to it as the density fluctuations do. Despite the fact that the equilibrium temperature gradient contains free energy, this free energy is not used by the waves in the sense that it 
is dissipated before being transfered to the electrostatic potential. The reason for the difference
between the density and temperature responses is the extra dissipation routes for the temperature fluctuations, namely, the parallel heat conduction and electron-ion heat exchange.
One should therefore be careful in assuming that adding free energy sources to an analysis will automatically increase instability drive.
The same type of result was seen in a study of tokamak edge turbulence \cite{zeiler1997}. \\


Next, Fig. \ref{nc_dynamics_figures}c illustrates the perpendicular kinetic energy dynamics provided by the electrostatic potential $\phi$. 
Since there is no free energy source for the potential ($Q_\phi=0$),
the potential fluctuations derive their energy from the parallel current through the $C_\phi$ transfer channel, which is positive everywhere and only finite for finite $n$. Otherwise, ion-neutral
collisions and viscosity dissipate energy from the potential fluctuations as shown by the $D_\phi$ curves. \\

The last piece, the parallel dynamics, also called the adiabatic response, is displayed in Fig. \ref{nc_dynamics_figures}d. 
The primary effect of the adabatic response is to take energy from the density
fluctuations and transfer it to the potential fluctuations, which only occurs at finite parallel wavenumber. Resistivity dissipates a fair portion of this energy, and in the linear regime, provides
the primary phase shift mechanism between the density and potential that allows for instability. The temperature fluctuations likewise draw energy through this response, although this is
quite negligible compared to the other effects. \\

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{dEdt_tot_mn}~a)
\hfil
\includegraphics[width=0.48\textwidth,height=60mm]{lin_vs_nl_gamma}~b)
\hfil
\caption{\textbf{a)} The total spectral nonconservative energy injection $\pdiff{E(k)}{t} \big|_{nl} = \sum_j Q_j(k) + C_j(k) + D_j(k)$ and
\textbf{b)} the spectral nonconservative growth rate spectrum $\gamma(k)_{nl} = [\sum_j Q_j(k) + C_j(k) + D_j(k)]/[2 \sum_j E_j(k)]$ averaged over the saturated phase
compared to the linear growth rate spectrum ($\gamma_L$).}
\label{dEdt_tot_fig}
\end{figure}

Finally, Fig. \ref{dEdt_tot_fig} shows the total spectral nonconservative energy rate of change in the turbulent state. Fig. \ref{dEdt_tot_fig}a reveals a global picture in wavenumber space of
where the total energy is injected into the system and where it is dissipated. Namely, energy is primarily injected at $(n=0, 10<m<60)$, while it is dissipated at $(n=0, m<5)$ and at $n=\pm 1$
for all $m$. This is quite different than what one would expect from the standard hydrodynamic instability picture in which energy is injected where the linear growth rate is positive and dissipated
where it is negative. To clarify this point, the linear $\gamma(k)_L$ versus nonlinear growth rate $\gamma(k)_{nl}$ spectra are shown in Fig. \ref{dEdt_tot_fig}b. Note that the linear growth rate
is positive for $(n=-1, 30<m<100)$ and negative everywhere else. Seemingly, the linear physics is completely washed out in the turbulent state. \\

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{T_m}~a)
\hfil
\includegraphics[width=0.48\textwidth,height=60mm]{T_n}~b)
\hfil
\caption{\textbf{a)} Conservative nonlinear energy transfer functions $T_j(k,k')$ summed over $k'$ and $n$. Positive values indicate energy transfer into structures with azimuthal mode number $m$.
\textbf{b)} Transfer functions summed over $k'$ and $m$. Note that $T_v(k,k')$ is multiplied by $20$ to make it visible.}
\label{conservative_transfers}
\end{figure}


Although the nonconservative linear term analysis is primary in revealing the energy injection and dissipation routes of the turbulence, the conservative nonlinear transfer analysis completes
the picture of energy dynamics. The difficulty in looking at the nonlinear transfer functions ($T_{j}(k,k')$ in equation \ref{dEdt_j}) is that they are four dimensional functions $(m,n,n',m')$, 
which makes complete visualization impossible. It is therefore convenient to sum over various transfers or look at specific wavenumber transfers of interest. The most easily decipherable
results that compliment the results of Fig. \ref{nc_dynamics_figures} are shown in Fig. \ref{conservative_transfers}. First, Fig. \ref{conservative_transfers}a illustrates the azimuthal mode
number conservative wavenumber transfers. Note that the sum of each individual curve over $m$ is zero because the nonlinearities are conservative. The density and temperature nonlinearities
are qualitatively similar in that they cause both forward and inverse transfer out of the wavenumbers that inject the most energy. The potential (polarization) and parallel velocity 
nonlinearities cause inverse transfer to low wavenumbers. \\

Fig. \ref{conservative_transfers}b displays the conservative transfers into and out
of different parallel modes. As expected from Fig. \ref{nc_dynamics_figures}b, density potential energy is transfered from $n=0$ convective cells into $n \ne 0$ modes. This can be called a direct
transfer in analogy with the terminology used for perpendicular wavenumber transfer. The temperature fluctuations have the same transfer tendancy 
as the density fluctuations, while the parallel velocity exhibits direct transfer, although from $n=1$ to higher modes since there is never any $n=0$ energy in the parallel velocity.
The potential fluctuations, on the other hand, exhibit inverse parallel wavenumber transfer, populating $n=0$ potential structures. This nonlinear transfer is the only way to drive energy into
$n=0$ potential structures because $Q_\phi=0$. Furthermore, this inverse transfer is necessary to drive the convective cells because $Q_n(m,n=0)$ and $Q_t(m,n=0)$ require finite $\phi_{m,n=0}$. \\

\begin{figure}
\includegraphics[width=0.3\textwidth,height=40mm]{nl_instability_diagram}
\hfil
\caption{Diagram of the nonlinear instability process that drives convective cells.}
\label{nl_instability_diagram}
\end{figure}


It is now clear that the convective cells draw their energy from a multi-step nonlinear process. Fig. \ref{nl_instability_diagram} outlines the crucial steps in the process. 
First, the $n=0$ density and potential fluctuations nonconservatively draw energy from the equilibrium density gradient as prescribed by $Q_n(m,n=0)$ defined in equation \ref{Qnk}, and feed
this energy into the $n=0$ density fluctuations only. Second, this
convective cell energy is conservatively transfered to $n \ne 0$ density fluctuations by the nonlinear $T_n(k,k')$ transfer process. The third step involves the transfer at finite $n$ from the density
fluctuations to the potential fluctuations by way of the parallel current in the adiabatic response. Fourth and finally, the $T_\phi(k,k')$ interaction conservatively transfers energy from
$n \ne 0$ to $n=0$ potential $\phi_{m,n=0}$ fluctuations in inverse fashion, at which point the process starts over. This is a clear case of a nonlinear instability as convective cells
are nonconservatively fed by a process that relies on the nonlinearities since the linearities alone cannot do this. This shows that linear instabilities need not be completely absent 
for a system to display nonlinear instability. \\


\section{Linear vs nonlinear drive}


%{\bf Issues to address:} \\
%- Parallel boundary conditions \\
%- What is the definition of a nonlinear instability and when can one say that a nonlinear instability is the primary mechanism over linear instability? \\
%- Comparison of simulation and experimental phases \\
%
%
%\begin{figure}
%\includegraphics[width=0.8\textwidth,height=60mm]{ni_phi_phases}
%\hfil
%\caption{The $n-\phi$ phase histogram in the linear evolution and saturated turbulence phases. The phase is defined as $\Theta = {\rm ln \ Im} (\phi_k n_k^*)$}
%\label{ni_phi_m_phases}
%\end{figure}
%
%\begin{figure}
%\includegraphics[width=0.5\textwidth,height=60mm]{ni_phi_f_phases}
%\hfil
%\caption{The $n-\phi$ frequency phase histogram in the saturated turbulence phase. The phase is defined as $\Theta = {\rm ln \ Im} (\phi_\omega n_\omega^*)$}
%\label{ni_phi_f_phases}
%\end{figure}

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{gamma_no_n0}~a)
\hfil
\includegraphics[width=0.48\textwidth,height=60mm]{gamma_no_n0_withzf}~b)
\hfil
\caption{\textbf{a)} The nonlinear growth rate spectrum $\gamma(k)_{nl}$ with $n=0$ density and potential components removed from the 
simulation compared to the linear growth rate spectrum $\gamma(k)_L$.
\textbf{b)} The solid lines are the same $\gamma(k)_{nl}$ spectrum as the solid lines in (a), but the dashed lines are the nonlinear growth rate spectrum when the zonal flows are retained
in the simulation.}
\label{gamma_no_n0_figs}
\end{figure}


Although the nonlinear convective cell dynamics present a clear case of nonlinear instability, the $n \ne 0 \leftrightarrow n=0$ energy path is not a necessary feature of nonlinear drift wave
instabilities, which is clear in tokamak studies of drift wave turbulence \cite{zeiler1996,zeiler1997,scott2002,scott2003,scott2005}. Furthermore, the periodic axial boundary conditions
used in the LAPD turbulence simulation which allow for axial Fourier eigenmodes (including those with $n=0$) are obviously unphysical. Eliminating the convective cells is then instructive
in determining how robust the nonlinear instability is in this instance of drift wave turbulence. There are a few ways to eliminate the convective cells in the simulation such as
eliminating one of the nonlinearities that is essential to the nonlinear instability process described in Fig. \ref{nl_instability_diagram}. However, simply subtracting out the $n=0$
components of the density and potential at each simulation time step retains more of the physics that may be essential to cause nonlinear instability. The results of such a simulation
are shown in Fig. \ref{gamma_no_n0_figs}. Interestingly, the nonlinear growth rate spectrum $\gamma(k)_{nl}$ is nearly identical to the linear growth rate spectrum $\gamma(k)_L$, as seen in
Fig. \ref{gamma_no_n0_figs}a. It is noted that subtracting out the $n=0$ potential component removes the zonal flow ($m=n=0$) from the system, providing a possible explanation for the large change
in behavior of the nonlinear growth rate spectrum. However, this hypothesis is dispelled by the analysis of a simulation in which only the $n=0, m \ne 0$ potential components are removed while 
the zonal flow is left intact. The growth rate spectrum of this simulation, shown in Fig. \ref{gamma_no_n0_figs}b, reveals that the zonal flow plays a minimal role in the nonlinear instability
dynamics. The zonal flow simply decreases the growth rates by a small amount, causing no change to the qualitative picture. Therefore, the finite $m$ convective cells or at least an axial
wavenumber transfer is necessary for a nonlinear instability to overtake the linear instability in driving the turbulence.

\section{More figures}

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{f_spectra}
\hfil
\caption{Comparison of the frequency spectra. Notice the spectra with $n=0$ components removed is not broadband, but has a clear peak, which is inconsistent with experiment.}
\label{freq_spectra}
\end{figure}

\begin{figure}
\includegraphics[width=0.48\textwidth,height=60mm]{gamma_zeroparbndry}~a)
\hfil
\includegraphics[width=0.48\textwidth,height=60mm]{gamma_double_length}~b)
\hfil
\includegraphics[width=0.48\textwidth,height=60mm]{gamma_no_nl_pol}~b)
\hfil
\caption{\textbf{a)} The nonlinear growth rate spectrum $\gamma(k)_{nl}$ compared to the linear spectrum $\gamma(k)_L$ with the parallel boundaries fixed to zero value rather than periodic. While
the nonlinear spectrum is quite different from the linear spectrum, it is much less different than in the case with periodic boundaries. The positive $n=-1$ growth rate is qualitatively different
in the different boundary condition cases.
\textbf{b)} The solid lines are the same $\gamma(k)_{nl}$ spectrum as the solid lines in the standard case, but the dashed lines are the nonlinear growth rate spectrum when the machine length is
doubled in the simulation. The qualitative picture is the same, but the nonlinear instability affect is stronger for the longer machine. 
\textbf{c)} The nonlinear growth rate when the nonlinear polarization current (vorticity nonlinearity) is removed from the simulation compared to the linear spectrum. The nonlinear instability
mechanism is cut out and the nonlinear spectrum is fairly similar to the linear spectrum. This case is similar to that when the $n=0$ components are removed.}
\label{gamma_no_n0_figs}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\appendix

\section{Explicit Calculation of the Energy Evolution of a Fourier Mode}

The energy evolution for each Fourier wave mode can be obtained by Fourier decomposing each of equations \ref{ni_eq} - \ref{te_eq}
and then multiplying the density, electron parallel velocity, vorticity, and electron temperature equations by the complex conjugates of the 
density, velocity, potential, and temperature respectively, and integrating over space.
Adding the resulting equations gives the energy evolution of each Fourier mode.

Take the density equation as an example for this procedure. The decomposition for the density is:

\beq
\label{density_decomp}
N(r,\theta,z,t) = \sum_{k} n_k(r,t) e^{i(m \theta + k_z z)}.
\eeq

Recall that the subscript $k$ is short for $(m,n)$ as the decomposition is a 2D Fourier decomposition in the azimuthal and axial directions, making the sum over $k$ truly
a double sum over $m$ and $n$. Furthermore, positive and negative
$m$ and $n$ are included in the sums to ensure reality of $N$, which also requires that $n_{-k} = n_k^*$.
Similar decompositions are used for $\vpe$ and $\phi$. The density source is azimuthally symmetric, so it is decomposed as:

\beq
\label{source_decomp}
S_N(r,z,t) = \sum_{k_z} S_{N k_z}(r,t) e^{i k_z z}.
\eeq

Substituting this decomposition into equation \ref{ni_eq} gives:

\beqar
\label{density_eq_fourier}
\sum_{k} \pdiff{n_k}{t} e^{i(m \theta + k_z z)} = \sum_{k_z} S_{N k_z} e^{i k_z z} + \nonumber \\
\sum_{k} \left[ -\frac{i m}{r} \pdr N_0 \phi_k - i k N_0 v_k + \mu_N(\pdrr n_k + \frac{1}{r} \pdr n_k - \frac{m^2}{r^2} n_k) \right] e^{i(m \theta + k_z z)} \nonumber \\
+ \frac{1}{r} \sum_{k,k'} (i m n_k \pdr \phi_{k'} - i m' \pdr n_k \phi_{k'}) e^{i (m + m') \theta + i (k_z + k'_z) z}.
\eeqar

Multiplying through by $n_{k''}^* e^{- i m'' \theta - i k''_z z}$ and integrating over space (and permutting primes) gives:

\beqar
\label{density_evolution}
\left< \pdiff{n_k}{t} n_k^* \right> = \left< S_{N k_z} n_{m=0,k_z}^* \right>  \nonumber \\
\left< -\frac{i m}{r} \pdr N_0 \phi_k n_k^* - i k N_0 v_k n_k^* + \mu_N( \pdrr n_k + \frac{1}{r} \pdr n_k - \frac{m^2}{r^2} n_k) n_k^*  \right> \nonumber \\
+ \left< \frac{1}{r} \sum_{k'} \left( i m' n_{k'} \pdr \phi_{k-k'} n_k^*  - i (m - m') \pdr n_{k'} \phi_{k-k'} n_k^*        \right) \right>.
\eeqar

Finally, taking the real part of this equation results in:

\beqar
\label{real_density_evolution}
\left< \frac{1}{2} \pdiff{|n_k|^2}{t} \right> = Re \left\{ \left< S_{N k_z} n_{m=0,k_z}^* \right> \right\} \nonumber \\
Re \left\{ \left< -\frac{i m}{r} \pdr N_0 \phi_k n_k^* - i k N_0 v_k n_k^* + \mu_N( \pdrr n_k + \frac{1}{r} \pdr n_k - \frac{m^2}{r^2} n_k) n_k^* \right> \right\} \nonumber \\
+ Re \left\{ \left< \frac{1}{r} \sum_{k'} \left( i m' n_{k'} \pdr \phi_{k-k'} n_k^*  - i (m - m') \pdr n_{k'} \phi_{k-k'} n_k^*        \right) \right> \right\}.
\eeqar

Note that taking the real part of the equation produces the expected energy-like term on the left hand side because:

\beq
\frac{1}{2} \pdiff{|n_k|^2}{t} = Re \left\{ \pdiff{n_k}{t} n_k^* \right\}.
\eeq

Breaking the result into explicit parts:

\beqar
\label{Fourier_density_evolution}
\pdiff{E_n(k)}{t} & = & Q_n(k) + C_n(k) + D_n(k) + \sum_{k'} T_n(k,k') \\
E_n(k) & = & \frac{1}{2} \left< |n_k|^2 \right> \\
Q_n(k) & = & Re \left\{ \left< -\frac{i m}{r} \pdr N_0 \phi_k n_k^* \right> \right\} \\
C_n(k) & = & Re \left\{ \left< - i k N_0 v_k n_k^* \right> \right\} \\
D_n(k) & = & Re \left\{ \left<  \mu_N( \pdrr n_k + \frac{1}{r} \pdr n_k - \frac{m^2}{r^2} n_k) n_k^*  + S_{N k_z} n_{m=0,k_z}^*  \right> \right\} \\
T_n(k,k') & = & Re \left\{ \left< \frac{1}{r} \left( i m' n_{k'} \pdr \phi_{k-k'} n_k^*  - i (m - m') \pdr n_{k'} \phi_{k-k'} n_k^*        \right) \right> \right\}
\eeqar

$Q_n(k)$ is the source, $C_n(k)$ is the transfer channel, $D_n(k)$ is dissipation, and $T_n(k,k')$ is spectral energy transfer.
The same type of procedure may be applied to equations \ref{ve_eq}-\ref{te_eq}. 
However, the double primed conjugate multiplications (as in the step between equations \ref{density_eq_fourier} and 
\ref{density_evolution}) must be done with the Fourier fields, $\fmei v_{k''}$,  $- \phi_{k''}$, and $\frac{3}{2} t_{k''}$ rather than 
$v_{k''}$, $\varpi_{k''}$, and $t_{k''}$.
These produce the correct energy terms, and most importantly still conserve the nonlinearities. The corresponding expressions for the perpendicular kinetic energy are:

\beqar
\label{Fourier_phi_evolution}
\pdiff{E_\phi(k)}{t} & = & Q_\phi(k) + C_\phi(k) + D_\phi(k) + \sum_{k'} T_\phi(k,k') \\
E_\phi(k) & = & \frac{1}{2} \left<  N_0 \left| \pdiff{\phi_k}{r} \right|^2 + N_0 \frac{m^2}{r^2} |\phi_k|^2  \right>\\
Q_\phi(k) & = & 0 \\
C_\phi(k) & = & Re \left\{ \left< i k_z N_0 v_k \phi_k^* \right> \right\} \\
D_\phi(k) & = & Re \left\{ \left<  - \mu_\phi( \pdrr \varpi_k + \frac{1}{r} \pdr \varpi_k - \frac{m^2}{r^2} \varpi_k) \phi_k^* -  \nuin E_\phi(k)\right> \right\} \\
T_\phi(k,k') & = & Re \left\{ \left< - \frac{1}{r} \left( i m' \varpi_{k'} \pdr \phi_{k-k'} \phi_k^*  - i (m - m') \pdr \varpi_{k'} \phi_{k-k'} \phi_k^*        \right) \right> \right\}
\eeqar

and for the electron temperature potential energy:

\beqar
\label{Fourier_te_evolution}
\pdiff{E_t(k)}{t} & = & Q_t(k) + C_t(k) + D_t(k) + \sum_{k'} T_t(k,k') \\
E_t(k) & = & \frac{3}{4} \left< |t_k|^2  \right> \\
Q_t(k) & = & Re \left\{ \left< - \frac{3}{2} \frac{i m}{r} \pdr T_{e0} \phi_k t_k^* \right> \right\} \\
C_t(k) & = & Re \left\{ \left<  - 1.71 i k_z T_{e0} v_k t_k^* \right> \right\} \\
D_t(k) & = & Re \left\{ \left< -\frac{\kpe}{N_0} k_z^2 |t_k|^2  - \frac{3 m_e}{m_i} \nue |t_k|^2 
+ \frac{3}{2} \mu_T( \pdrr t_k + \frac{1}{r} \pdr t_k - \frac{m^2}{r^2} t_k) t_k^*  + \frac{3}{2} S_{T k_z} t_{m=0,k_z}^*  \right> \right\} \\
T_t(k,k') & = & Re \left\{ \left< \frac{3}{2 r} \left( i m' t_{k'} \pdr \phi_{k-k'} t_k^*  - i (m - m') \pdr t_{k'} \phi_{k-k'} t_k^*        \right) \right> \right\}
\eeqar

and for the parallel kinetic energy:

\beqar
\label{Fourier_vpar_evolution}
\pdiff{E_v(k)}{t} & = & Q_v(k) + C_v(k) + D_v(k) + \sum_{k'} T_v(k,k') \\
E_v(k) & = & \frac{1}{2} \fmei \left< |v_k|^2 \right> \\
Q_v(k) & = & Re \left\{ \left<  i k_z \frac{N_0^2 - T_{e0}}{N_0} n_k v_k^* + i k_z (1 - N_0) \phi_k v_k^* + 1.71 i k_z (T_{e0} -1) t_k v_k^*   \right> \right\} \\
C_v(k) & = & Re \left\{ \left< - i k_z N_0 n_k v_k^* + i k_z N_0 \phi_k v_k^* - 1.71 i k_z T_{e0} t_k v_k^*  \right> \right\} \\
D_v(k) & = & Re \left\{ \left< - \nue \fmei |v_k|^2   \right> \right\} \\
T_v(k,k') & = & Re \left\{ \fmei \left< \frac{1}{r} \left( i m' v_{k'} \pdr \phi_{k-k'} v_k^*  - i (m - m') \pdr v_{k'} \phi_{k-k'} v_k^*        \right) \right> \right\}
\eeqar

The transfer channel $C_v(k)$ is specifically set so that $C_n(k) + C_t(k) + C_\phi(k) + C_v(k) = 0$. 
The source $Q_v(k)$ is the left over quantity, which can have any sign and contributes to the overall energy evolution.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%\bibliographystyle{phaip}
\bibliographystyle{unsrt}
\bibliography{refs}

%
%

\end{document}
